# Data Feed

PrExploit provides a official data feed via the [prexploit-data](https://github.com/prexploit/prexploit-data) Github repository .

## Data Content

This repository has two types of JSON data. The first is a file for each CVE number as ```CVE-YYYY-XXXX.json``` and the second is a file for CVEs published in the same year as ```CVE-YYYY.json```.
PrExploit supposes CVEs with CVSS v3 data therefore the data feed only contains CVEs published after 2016-01-01.

## Data Format

Each CVE has the following data

- ```score```: exploit probability
- ```explanations```: List of feature name and [SHAP](https://github.com/slundberg/shap) value.
  - The SHAP values represent a feature's responsibility for a change in the model output or, the values mean a force that either increases or decreases the prediction.
  - See the [Model Features](./features.md) section about feature's naming conventions.
- ```update_datetime```: last modfied timestamp

### Example

```
{
    "score": 0.725,
    "explanations": {
        "C:CPE_VENDOR:MICROSOFT==1.0": 1.848,
        "T:NP:MICROSOFT_EDGE==1.0": 0.567,
        "T:NP:CVE_ID==1.0": 0.522,
        "T:NP:OBJECTS==1.0": 0.448,
        "C:CVSS_C:HIGH==1.0": 0.325,
        "C:CVSS_AC:HIGH==1.0": 0.214,
        "C:CVSS_I:HIGH==1.0": 0.155,
        "C:CVSS_AV:NETWORK==1.0": 0.15,
        "T:NP:REMOTE_CODE_EXECUTION_VULNERABILITY==1.0": 0.135,
        "C:CVSS_PR:NONE==1.0": 0.097,
        "C:CPE_PRODUCT:CHAKRACORE==1.0": -1.007,
        "T:NP:HTML==1.0": -1.005,
        "T:NP:WAY==1.0": -0.371,
        "C:CPE_VENDOR:ADOBE==0.0": -0.182,
        "T:NP:ARBITRARY_CODE==0.0": -0.092,
        "T:NP:REMOTE_ATTACKERS==0.0": -0.079,
        "C:CPE_PRODUCT:FLASH_PLAYER==0.0": -0.076,
        "N:CPE_#TYPE:A==2.0": -0.071,
        "T:NP:WINDOWS==0.0": -0.07,
        "T:NP:REMOTE_CODE_EXECUTION==0.0": -0.055
    },
    "update_datetime": "2021-01-16T21:50:08.427613"
}
```

## How Update ?

### Model
On the first day of every month, prexploit fetch all NVD and exploitation data and train a new model. 
Because exploitation data may not support recent vulnerabilities, the training dataset excludes vulnerabilities published last 30 days.

### Data
prexploit fetch the ```CVE-Modified``` JSON file from NVD every 2 hours and predict all scores for these modified CVEs.
Any CVEs may be modified for updates of description, newly affected CPEs, additional references, and mistakes. 
Also, on the first day of every month, all data updated by using the newly trained model.


